××” ×¦×¨×™×š ×œ×¢×©×•×ª?

×‘×›×œ ×¨×©×•××” ×©×ª×™×•×•×¦×¨, ×ª×™×™×¦×¨ recordId ×§×‘×•×¢ ×•×ª×©×œ×— ××•×ª×• ×œ×©×¨×ª.

×ª×•×¡×™×£ ×¤×•× ×§×¦×™×” ××—×ª ×œ××¢×œ×”:

×©×™× ×œ×™×“ ×”Ö¾helpers ×©×œ×š:

function generateRecordId() {
  return 'rec_' + Date.now() + '_' + Math.random().toString(16).slice(2);
}

3) ×ª×™×§×•×Ÿ ×‘×§×•×“: addRecord ×—×™×™×‘ ×œ×©××•×¨ recordId ×•×œ×©×œ×•×— ××•×ª×• ×œ×©×¨×ª

×‘×ª×•×š addRecord() ×œ×¤× ×™ ×”Ö¾payload ×ª×•×¡×™×£:

const recordId = generateRecordId();


×•×‘×ª×•×š ×”Ö¾payload ×ª×•×¡×™×£ ×©×“×” ×—×“×©:

recordId: recordId,


×›×œ×•××¨ ×‘Ö¾payload:

const payload = {
  action: "submit",
  recordId: recordId,
  employeeId: localStorage.getItem("employeeId") || empNum,
  employeeName: localStorage.getItem("employeeName") || empName,
  attendanceDate: date,
  startTime: startTime,
  endTime: endTime,
  workHours: hours,
  activityType: activity,
  schoolName: school,
  municipality: municipality,
  programName: program,
  sessionNumber: session,
  kilometers: km,
  totalExpenses: totalExpenses,
  expensesDetails: expensesDetail,
  notes: notes,
  attachments: attachments,
  attachmentsNames: formatAttachments(attachments)
};


âš ï¸ ×•×’× ×‘Ö¾loadMyRecordsFromServer() ×¦×¨×™×š ×œ×©××•×¨ ××ª recordId ×× ××’×™×¢ ××”×©×¨×ª.

×©× ×” ××ª ×”××™×¤×•×™ ×œ:

records = data.records.map(rec => ({
  recordId: rec.recordId || rec.id || `${rec.employeeId}_${rec.attendanceDate}_${rec.startTime}`,
  ...
}));

4) ×œ×”×•×¡×™×£ API ×œ×¢×¨×™×›×” ×•××—×™×§×” (×“×¨×š Logic App)

×”×§×•×“ ×©×œ×š ×¦×¨×™×š ×œ×©×œ×•×— ×œ×©×¨×ª ×’×:

action: "updateRecord"

action: "deleteRecord"

4.1 ×¤×•× ×§×¦×™×” ×—×“×©×”: updateRecordOnServer

×”×“×‘×§ ××ª×—×ª ×œÖ¾loadMyRecordsFromServer():

async function updateRecordOnServer(updatedRecord) {
  const payload = {
    action: "updateRecord",
    recordId: updatedRecord.recordId,
    employeeId: updatedRecord.empNum,
    attendanceDate: updatedRecord.date,
    startTime: updatedRecord.start,
    endTime: updatedRecord.end,
    workHours: updatedRecord.hours,
    activityType: updatedRecord.activity,
    schoolName: updatedRecord.school,
    municipality: updatedRecord.municipality,
    programName: updatedRecord.program,
    sessionNumber: updatedRecord.session,
    kilometers: updatedRecord.km,
    totalExpenses: updatedRecord.totalExpenses,
    expensesDetails: updatedRecord.expensesDetail,
    notes: updatedRecord.notes
  };

  const res = await fetch(LOGIC_APP_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  return res.ok;
}

4.2 ×¤×•× ×§×¦×™×” ×—×“×©×”: deleteRecordOnServer

×”×“×‘×§ ×’×:

async function deleteRecordOnServer(recordId) {
  const res = await fetch(LOGIC_APP_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      action: "deleteRecord",
      recordId: recordId
    })
  });

  return res.ok;
}

5) ×œ×©× ×•×ª saveEdit ×›×š ×©×™×¢×“×›×Ÿ ×’× ×‘×©×¨×ª

×‘Ö¾saveEdit() ××—×¨×™ ×©××ª×” ×‘×•× ×” ××ª ×”×¨×©×•××” ×”×—×“×©×”, ××ª×” ×¢×•×©×”:

saveToLocalStorage();
updateStats();
renderRecordsTable();
closeEditModal();
showAlert('âœ… ×”×¨×©×•××” ×¢×•×“×›× ×” ×‘×”×¦×œ×—×”!', 'success');


×¦×¨×™×š ×œ×©× ×•×ª ×œ×–×¨×™××” × ×›×•× ×”:

×”×—×œ×£ ××ª ×”×—×œ×§ ×”×–×” ×‘:
showAlert('ğŸ”„ ××¢×“×›×Ÿ ×¨×©×•××” ×‘×©×¨×ª...', 'info');

try {
  const ok = await updateRecordOnServer(records[editingIndex]);

  if (!ok) {
    showAlert('âš ï¸ ×”×¢×“×›×•×Ÿ × ×©××¨ ××§×•××™×ª ××‘×œ × ×›×©×œ ×‘×©×¨×ª', 'error');
    return;
  }

  await loadMyRecordsFromServer(); // ××©×™×›×” ××—×“×© = ×¡× ×›×¨×•×Ÿ ××œ×

  closeEditModal();
  showAlert('âœ… ×”×¨×©×•××” ×¢×•×“×›× ×” ×‘×”×¦×œ×—×” ×•× ×©××¨×” ×‘×©×¨×ª', 'success');
} catch (e) {
  console.error(e);
  showAlert('âŒ ×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”×¨×©×•××” ×‘×©×¨×ª', 'error');
}

6) ×œ×©× ×•×ª deleteRecord ×›×š ×©×™××—×§ ×’× ×‘×©×¨×ª

×”×¤×•× ×§×¦×™×” ×©×œ×š ×›×¨×’×¢ ××•×—×§×ª ×¨×§ ××§×•××™×ª.

×”×—×œ×£ ××ª deleteRecord ×‘×’×¨×¡×” ×”×–××ª:
async function deleteRecord(index) {
  const rec = records[index];
  if (!rec) return;

  if (!confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ×¨×©×•××” ×–×•?')) return;

  showAlert('ğŸ—‘ï¸ ××•×—×§ ×¨×©×•××”...', 'info');

  try {
    const ok = await deleteRecordOnServer(rec.recordId);

    if (!ok) {
      showAlert('âŒ ××—×™×§×” × ×›×©×œ×” ×‘×©×¨×ª', 'error');
      return;
    }

    await loadMyRecordsFromServer();
    showAlert('âœ… ×”×¨×©×•××” × ××—×§×” ××”×©×¨×ª ×‘×”×¦×œ×—×”', 'success');
  } catch (e) {
    console.error(e);
    showAlert('âŒ ×©×’×™××” ×‘××—×™×§×” ××”×©×¨×ª', 'error');
  }
}

7) ×ª×™×§×•×Ÿ ×—×©×•×‘: ××œ ×ª×©×ª××© ×™×•×ª×¨ ×‘Ö¾attendanceRecords ×›×‘×¡×™×¡ ×××ª

×›×¨×’×¢ ×™×© ×œ×š:

saveToLocalStorage() {
  localStorage.setItem('attendanceRecords', JSON.stringify(records));
}


×–×” ×‘×¡×“×¨ ×¨×§ ×œ×§××© ×–×× ×™, ××‘×œ ×œ× ×›×××ª.

âœ… ×”×”××œ×¦×” ×©×œ×™:

×œ×”×©××™×¨ LocalStorage ×¨×§ ×œ×”×¦×’×ª × ×ª×•× ×™× ×›×©××™×Ÿ ××™× ×˜×¨× ×˜

××‘×œ ×‘×›×œ ×›× ×™×¡×” / ×›×œ ×¨×¢× ×•×Ÿ â€“ ×ª××™×“ ×œ××©×•×š ××”×©×¨×ª

×•×–×” ×›×‘×¨ ×§×™×™× ××¦×œ×š: loadMyRecordsFromServer() ğŸ‘